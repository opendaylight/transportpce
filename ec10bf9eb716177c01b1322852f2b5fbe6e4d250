{
  "pushCert": "certificate version 0.1\npusher 5FBDF9B9314FAD71 1749027290 +0200\npushee ssh://git.opendaylight.org:29418/transportpce\nnonce 1749027290-CC75342585DCB138E07CDD679D0F6C7C654D72EE\n\n0000000000000000000000000000000000000000 e0ed62dbfdbffa16be7f21deaa8187211e76f7ad refs/for/master\n-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEIKU9c2lqXpTzMWXlX735uTFPrXEFAmhACdoACgkQX735uTFP\nrXG1xRAAna3YebCZiZ55DGJiltMTHPy+G4JOHmkP+SZHUG6lqFxfKw+VoC6QAHYT\n5b+ouc7kIA3xEUIzPmSwxf0cgZsTu2b4UAq7Psw58brY9DCg85a20nddA3PE3BR5\nzaPWiEb8izVpIcWWjGpPTYMuZ/iO7+KjlNEySwUr6bHkh1scz3vw3qo82w7jq2ns\nLTkcNPeY7ZCTgZLfhWgVnTSR9dZexfBfh3G4hjvLcCZDwyUmaWF6S6zlkF0XNBmN\nfHGhZfF08OwZqHoBOzYl/LJaITLxlRmPgiXtRmeIz6tmYMD8xNKZcqXPBSGf0ZRn\nONSAsNi4DUL7NQpy5jB3/Re4WE0bvwyS9XW1br+voihzWhcOXLESEJQ3WVqpsnkJ\nzjQDOKCt/Z2/T72VyEUHHtSrmiAhSIe6NCI4cwAiN38NaLY2p/Q1a7L6GVXHgreS\n2UoJjGtc06soCalSdF+Iilr3jWd9er+ddWVGiLnHh0+epjT8m5EkJZSKdSxfZCha\nEyrlq7IP0vgsasRKAYVhKpF5xdOiC/36wAKuGPHqqTZ3ejfDzoojnt8fk6Zx+Vsc\nOTthnuMcDH0j1JPM1G/ugjsFbj4g/HWLG52GrW9ujcvkwsBQVedREPrCSLp2n8Jd\ntA8FjfkCSsQAyM12oAmu+j5JingmqhLyxVeawLH89t8Hkg7BjXU\u003d\n\u003d3o/p\n-----END PGP SIGNATURE-----\n",
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "9c9a7745_54e8eebf",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 9231
      },
      "writtenOn": "2025-06-04T11:05:23Z",
      "side": 1,
      "message": "recheck",
      "revId": "ec10bf9eb716177c01b1322852f2b5fbe6e4d250",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ee26a1cc_e7218736",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 7217
      },
      "writtenOn": "2025-06-04T12:00:45Z",
      "side": 1,
      "message": "Thanks Joakim. \nThe idea was that used wavelength reflects the wavelength used by the connected TSP: corresponds to a setting exercised at a time to configure on one PP port of the ROADMs \"SRG\" (or let say \"Add/drop\"), the Wavelength band it shall be passing through to its multiplexing port CP. There shall be only one MediaChannel (Center Freq + width) configured, and this is the reason why we take only the first item.\n\nAvailable wavelength in contrary corresponds to available frequency slots : as a regular WSS multiplexes several ports (PPs) onto the same output port (CP), it is most of the time blocking, meaning that if a channel is configured on one PP port, the same channel can not be used on any other port. Thus available wavelengths are all the ones that have not been set on any of the PP ports. It reflects what\u0027s available from current configuration on the different PP ports.\n\nWhat you propose makes sense : merging both comes down to give the visibility of what\u0027s available on the CP port, down to the PP port. But we lose a level of information. Used shall reflect what’s configured on the port, available, what could be provisioned on the port, whether the port is free or not (one wavelength provisioned). Then, the question is do we need to backport this information to the PP, since it is still available at the CP which will be part of the path and will be analyzed by the PCE when it computes the available spectrum on the full path.\n\nPlease note that it also has some implications. In TapiNetworkModelServiceImpl, populateNepsforRdmNodes, Neps are created based on the result of the getPP11UsedWavelength. If the result shows one wavelength is provisioned on the port, this triggers the creation of an OTSiMC and an MC Nep (Line 2032/2034). (We currently make a shortcut, computing available wavelength on that port ignoring what is provisioned on the other ports and I will need to correct this : line 2027). \n\nIf we apply your change, OTSiMC and MC will be created as soon as another wavelength has been provisioned on the SRG block, which is not what we want. You won’t see it directly, because we are lacking some tests there: the result will be seen in the generated topology, which is tested only indirectly, as we use the full topology file to test the PCE, but do not regenerate the topo automatically. \n\nTo be honest, I did not spend to much time building the tests on this part of the code. The reason is that building this topology took a very long time, and is only an intermediate step. At the end the topology saved in the data store (translation of OR topo to tapi topo) will only be a summarized abstracted topo, not the full one. I am not saying this is great, just that as we are missing some resources we try to do our best to have something that works….\n\nThus  I would prefer not to merge the information of used and available wavelength.",
      "revId": "ec10bf9eb716177c01b1322852f2b5fbe6e4d250",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d861db55_7d31c0f9",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 8358
      },
      "writtenOn": "2025-06-04T21:06:54Z",
      "side": 1,
      "message": "I\u0027m a bit confused by this discussion. I think TransportPCE never sets the used-wavelength attribute in openroadm-topology, only available-freq-map.",
      "parentUuid": "ee26a1cc_e7218736",
      "revId": "ec10bf9eb716177c01b1322852f2b5fbe6e4d250",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "1698aa60_33913035",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 9231
      },
      "writtenOn": "2025-06-05T12:09:56Z",
      "side": 1,
      "message": "recheck",
      "revId": "ec10bf9eb716177c01b1322852f2b5fbe6e4d250",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "12a68e2f_f07492c3",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 7217
      },
      "writtenOn": "2025-06-12T12:45:15Z",
      "side": 1,
      "message": "I am still consolidating the code for T-API and made the assumption the information is available to generate the topology. Did not realize the information was not there. \nSo you must be right on the fact that it is not set. Then if it is not set, we need to do it and modify the service handler so that at the end of service provisioning the used spectrum is set. This information is needed to check that a PP port is not already used. Especially in the context of Alien Wavelength and IPoWDM. \n\nSo we should add the setting of used spectrum one the one hand, and add a condition on the creation of a tunnel between 2 PP ports on the other hand (PP port not used check through used spectrum).",
      "parentUuid": "d861db55_7d31c0f9",
      "revId": "ec10bf9eb716177c01b1322852f2b5fbe6e4d250",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6242d6ed_f505681b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 7217
      },
      "writtenOn": "2025-06-12T12:45:15Z",
      "side": 1,
      "message": "Hi, replied to Jonas comments",
      "revId": "ec10bf9eb716177c01b1322852f2b5fbe6e4d250",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "afc3efe5_864d87d7",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 7217
      },
      "writtenOn": "2025-06-12T16:49:34Z",
      "side": 1,
      "message": "To make a summary of what was discussed during the TPCE meeting of the 12th of June (Please correct me if I am wrong)\n\nCurrently used spectrum is not populated on PP by tpce (whether this is volontary, deprecating used spectrum associated with Fix grid, or because we forgot to populate it after service is provisoned).\nCurrently, available spectrum on PP does not reflect spectrum occupation on the aggregating tp (CP of the SRG). \n-This is not an issue for path computation since the CP is part of the path, and as the PostAlgoValidator goes through each elements, including CP, to evaluate the spectrum occupation.\n-As far as the available spectrum on a PP port only reflects what is provisioned on the port itself, it can be used to evaluate whether the port is available or not.\n\nAs a result, you can follow both options you proposed :\n1- Merge of used wavelength and available spectrum information as proposed initially\n2- Remove in the code anything associated with used spectrum since this parameter is not correctly refreshed by tpce and unusable as such.\n\n@gilles.thouenon@orange.com : Gilles can you indicate your preference so that Joakim can proceed?\n\nLast but not least, realizing that used spectrum is not refreshed after service provisioning, I may need on my side to modify part of the TAPI code to generate topolgy, and will need to modify the code of the pceTapiNodes to prune ports based on available spectrum rather than used spectrum.\n\nThanks so much to all of you for bringing this issue to our eyes and helping in improving the code.",
      "revId": "ec10bf9eb716177c01b1322852f2b5fbe6e4d250",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "cd1b1f3c_2af156d1",
        "filename": "tapi/src/main/java/org/opendaylight/transportpce/tapi/topology/ORtoTapiTopoConversionTools.java",
        "patchSetId": 6
      },
      "lineNbr": 1282,
      "author": {
        "id": 8358
      },
      "writtenOn": "2025-06-05T08:49:51Z",
      "side": 1,
      "message": "Seems to me we can just remove the code based on UsedWavelength since that attribute is never set by TransportPCE in my understanding.",
      "revId": "ec10bf9eb716177c01b1322852f2b5fbe6e4d250",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "37fcf277_15c8c4bd",
        "filename": "tapi/src/main/java/org/opendaylight/transportpce/tapi/topology/ORtoTapiTopoConversionTools.java",
        "patchSetId": 6
      },
      "lineNbr": 1282,
      "author": {
        "id": 7217
      },
      "writtenOn": "2025-06-12T12:45:15Z",
      "side": 1,
      "message": "Would prefer to make it the reverse way. Keep it, and add what\u0027s missing to garantee that we can not create a service on a port that is already used.",
      "parentUuid": "cd1b1f3c_2af156d1",
      "revId": "ec10bf9eb716177c01b1322852f2b5fbe6e4d250",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "0a083fb5_08192b2c",
        "filename": "tapi/src/main/java/org/opendaylight/transportpce/tapi/topology/ORtoTapiTopoConversionTools.java",
        "patchSetId": 6
      },
      "lineNbr": 1282,
      "author": {
        "id": 9231
      },
      "writtenOn": "2025-06-30T12:45:43Z",
      "side": 1,
      "message": "If memory serves me right, we agreed on a meeting to only use available frequency map from the openroadm model. The code has been updated accordingly.",
      "parentUuid": "37fcf277_15c8c4bd",
      "revId": "ec10bf9eb716177c01b1322852f2b5fbe6e4d250",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81"
    }
  ]
}